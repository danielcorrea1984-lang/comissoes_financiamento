{"ast":null,"code":"import axios from 'axios';\nconst api = axios.create({\n  baseURL: 'http://127.0.0.1:5000'\n});\nconst TOKEN_KEY = 'token_v2';\nconst USER_KEY = 'user_info_v1';\nexport function setToken(token) {\n  if (token) {\n    api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    localStorage.setItem(TOKEN_KEY, token);\n  } else {\n    delete api.defaults.headers.common['Authorization'];\n    localStorage.removeItem(TOKEN_KEY);\n  }\n}\nexport function setUserInfo(user) {\n  if (user) {\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n  } else {\n    localStorage.removeItem(USER_KEY);\n  }\n}\nexport function getUserInfo() {\n  try {\n    return JSON.parse(localStorage.getItem(USER_KEY) || 'null');\n  } catch {\n    return null;\n  }\n}\n\n// reaplica token salvo\nconst saved = localStorage.getItem(TOKEN_KEY);\nif (saved) setToken(saved);\napi.interceptors.response.use(res => res, err => {\n  var _err$response;\n  const status = err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status;\n  if (status === 401 || status === 403 || status === 422) {\n    setToken(null);\n    setUserInfo(null);\n    if (window.location.pathname !== '/login') {\n      window.location.href = '/login';\n    }\n  }\n  return Promise.reject(err);\n});\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","TOKEN_KEY","USER_KEY","setToken","token","defaults","headers","common","localStorage","setItem","removeItem","setUserInfo","user","JSON","stringify","getUserInfo","parse","getItem","saved","interceptors","response","use","res","err","_err$response","status","window","location","pathname","href","Promise","reject"],"sources":["C:/Users/danielol/Desktop/AJ7/comissoes_financiamento/frontend/src/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({ baseURL: 'http://127.0.0.1:5000' });\r\n\r\nconst TOKEN_KEY = 'token_v2';\r\nconst USER_KEY = 'user_info_v1';\r\n\r\nexport function setToken(token){\r\n  if(token){\r\n    api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    localStorage.setItem(TOKEN_KEY, token);\r\n  } else {\r\n    delete api.defaults.headers.common['Authorization'];\r\n    localStorage.removeItem(TOKEN_KEY);\r\n  }\r\n}\r\n\r\nexport function setUserInfo(user){\r\n  if(user){\r\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\r\n  } else {\r\n    localStorage.removeItem(USER_KEY);\r\n  }\r\n}\r\n\r\nexport function getUserInfo(){\r\n  try{\r\n    return JSON.parse(localStorage.getItem(USER_KEY) || 'null');\r\n  }catch{\r\n    return null;\r\n  }\r\n}\r\n\r\n// reaplica token salvo\r\nconst saved = localStorage.getItem(TOKEN_KEY);\r\nif(saved) setToken(saved);\r\n\r\napi.interceptors.response.use(\r\n  res => res,\r\n  err => {\r\n    const status = err?.response?.status;\r\n    if (status === 401 || status === 403 || status === 422) {\r\n      setToken(null);\r\n      setUserInfo(null);\r\n      if (window.location.pathname !== '/login') {\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,GAAG,GAAGD,KAAK,CAACE,MAAM,CAAC;EAAEC,OAAO,EAAE;AAAwB,CAAC,CAAC;AAE9D,MAAMC,SAAS,GAAG,UAAU;AAC5B,MAAMC,QAAQ,GAAG,cAAc;AAE/B,OAAO,SAASC,QAAQA,CAACC,KAAK,EAAC;EAC7B,IAAGA,KAAK,EAAC;IACPN,GAAG,CAACO,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;IAChEI,YAAY,CAACC,OAAO,CAACR,SAAS,EAAEG,KAAK,CAAC;EACxC,CAAC,MAAM;IACL,OAAON,GAAG,CAACO,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;IACnDC,YAAY,CAACE,UAAU,CAACT,SAAS,CAAC;EACpC;AACF;AAEA,OAAO,SAASU,WAAWA,CAACC,IAAI,EAAC;EAC/B,IAAGA,IAAI,EAAC;IACNJ,YAAY,CAACC,OAAO,CAACP,QAAQ,EAAEW,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC;EACtD,CAAC,MAAM;IACLJ,YAAY,CAACE,UAAU,CAACR,QAAQ,CAAC;EACnC;AACF;AAEA,OAAO,SAASa,WAAWA,CAAA,EAAE;EAC3B,IAAG;IACD,OAAOF,IAAI,CAACG,KAAK,CAACR,YAAY,CAACS,OAAO,CAACf,QAAQ,CAAC,IAAI,MAAM,CAAC;EAC7D,CAAC,OAAK;IACJ,OAAO,IAAI;EACb;AACF;;AAEA;AACA,MAAMgB,KAAK,GAAGV,YAAY,CAACS,OAAO,CAAChB,SAAS,CAAC;AAC7C,IAAGiB,KAAK,EAAEf,QAAQ,CAACe,KAAK,CAAC;AAEzBpB,GAAG,CAACqB,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC3BC,GAAG,IAAIA,GAAG,EACVC,GAAG,IAAI;EAAA,IAAAC,aAAA;EACL,MAAMC,MAAM,GAAGF,GAAG,aAAHA,GAAG,wBAAAC,aAAA,GAAHD,GAAG,CAAEH,QAAQ,cAAAI,aAAA,uBAAbA,aAAA,CAAeC,MAAM;EACpC,IAAIA,MAAM,KAAK,GAAG,IAAIA,MAAM,KAAK,GAAG,IAAIA,MAAM,KAAK,GAAG,EAAE;IACtDtB,QAAQ,CAAC,IAAI,CAAC;IACdQ,WAAW,CAAC,IAAI,CAAC;IACjB,IAAIe,MAAM,CAACC,QAAQ,CAACC,QAAQ,KAAK,QAAQ,EAAE;MACzCF,MAAM,CAACC,QAAQ,CAACE,IAAI,GAAG,QAAQ;IACjC;EACF;EACA,OAAOC,OAAO,CAACC,MAAM,CAACR,GAAG,CAAC;AAC5B,CACF,CAAC;AAED,eAAezB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}