{"ast":null,"code":"import axios from 'axios';\nconst api = axios.create({\n  baseURL: 'http://127.0.0.1:5000'\n});\n\n// versão nova para invalidar tokens antigos\nconst TOKEN_KEY = 'token_v2';\nexport function setToken(token) {\n  if (token) {\n    api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    localStorage.setItem(TOKEN_KEY, token);\n  } else {\n    delete api.defaults.headers.common['Authorization'];\n    localStorage.removeItem(TOKEN_KEY);\n  }\n}\n\n// reaplica token salvo (nova chave)\nconst saved = localStorage.getItem(TOKEN_KEY);\nif (saved) setToken(saved);\n\n// Se 401/422, limpa token e volta pro login\napi.interceptors.response.use(res => res, err => {\n  var _err$response;\n  const status = err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status;\n  if (status === 401 || status === 422) {\n    setToken(null);\n    window.location.href = '/login';\n  }\n  return Promise.reject(err);\n});\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","TOKEN_KEY","setToken","token","defaults","headers","common","localStorage","setItem","removeItem","saved","getItem","interceptors","response","use","res","err","_err$response","status","window","location","href","Promise","reject"],"sources":["C:/Users/danielol/Desktop/AJ7/comissoes_financiamento/frontend/src/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({ baseURL: 'http://127.0.0.1:5000' });\r\n\r\n// versão nova para invalidar tokens antigos\r\nconst TOKEN_KEY = 'token_v2';\r\n\r\nexport function setToken(token){\r\n  if(token){\r\n    api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    localStorage.setItem(TOKEN_KEY, token);\r\n  } else {\r\n    delete api.defaults.headers.common['Authorization'];\r\n    localStorage.removeItem(TOKEN_KEY);\r\n  }\r\n}\r\n\r\n// reaplica token salvo (nova chave)\r\nconst saved = localStorage.getItem(TOKEN_KEY);\r\nif(saved) setToken(saved);\r\n\r\n// Se 401/422, limpa token e volta pro login\r\napi.interceptors.response.use(\r\n  res => res,\r\n  err => {\r\n    const status = err?.response?.status;\r\n    if (status === 401 || status === 422) {\r\n      setToken(null);\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,GAAG,GAAGD,KAAK,CAACE,MAAM,CAAC;EAAEC,OAAO,EAAE;AAAwB,CAAC,CAAC;;AAE9D;AACA,MAAMC,SAAS,GAAG,UAAU;AAE5B,OAAO,SAASC,QAAQA,CAACC,KAAK,EAAC;EAC7B,IAAGA,KAAK,EAAC;IACPL,GAAG,CAACM,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;IAChEI,YAAY,CAACC,OAAO,CAACP,SAAS,EAAEE,KAAK,CAAC;EACxC,CAAC,MAAM;IACL,OAAOL,GAAG,CAACM,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;IACnDC,YAAY,CAACE,UAAU,CAACR,SAAS,CAAC;EACpC;AACF;;AAEA;AACA,MAAMS,KAAK,GAAGH,YAAY,CAACI,OAAO,CAACV,SAAS,CAAC;AAC7C,IAAGS,KAAK,EAAER,QAAQ,CAACQ,KAAK,CAAC;;AAEzB;AACAZ,GAAG,CAACc,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC3BC,GAAG,IAAIA,GAAG,EACVC,GAAG,IAAI;EAAA,IAAAC,aAAA;EACL,MAAMC,MAAM,GAAGF,GAAG,aAAHA,GAAG,wBAAAC,aAAA,GAAHD,GAAG,CAAEH,QAAQ,cAAAI,aAAA,uBAAbA,aAAA,CAAeC,MAAM;EACpC,IAAIA,MAAM,KAAK,GAAG,IAAIA,MAAM,KAAK,GAAG,EAAE;IACpChB,QAAQ,CAAC,IAAI,CAAC;IACdiB,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACjC;EACA,OAAOC,OAAO,CAACC,MAAM,CAACP,GAAG,CAAC;AAC5B,CACF,CAAC;AAED,eAAelB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}